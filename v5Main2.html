<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
		<style>
			body,
			html {
				width: 100%;
				height: 100%;
				padding: 0px;
				margin: 0px;
				overflow: hidden;
			}

			.wrapper {
				width: 100%;
				height: 100%;
			}

			.Canvas {
				width: 100%;
				height: 100%;
				background: #000;
			}

			.obj {
				max-width: 100px;
				max-height: 100px;
			}
			.obj:hover {
				cursor: pointer;
				z-index: 1000;
				filter: contrast(150%);
			}

			.scoreboard {
				text-transform: uppercase;
				font-size: 1em;
				text-align: center;
				background-color: rgb(2, 167, 250);
				color: rgb(0, 18, 67);
				padding: 10px;
			}
		</style>
	</head>
	<body>
		<div class="wrapper">
			<canvas width="0" height="0" class="canvas" id="canvas"
				>Ваш браузер не поддерживает JavaScript и HTML5!</canvas
			>
		</div>
		<script>
			/* строим класс наших объектов при поможи конструктора */
			class Object {
				constructor(image, x, y) {
					this.x = x;
					this.y = y;
					this.loaded = false;
					this.dead = false;
					this.image = new Image();
					let obj = this;
					this.image.addEventListener("load", function () {
						obj.loaded = true;
					});
					this.image.src = image;
				}

				Update() {
					if (this.y > Canvas.height + 50) {
						this.dead = true;
					} else {
						this.y += speed;
					}
				}

				// Движение
				Move(v, d) {
					if (v == "x") {
						//Moving on x
						d *= 2;

						this.x += d; //Changing position

						//Rolling back the changes if the car left the screen
						if (this.x + this.image.width * scale > Canvas.width) {
							this.x -= d;
						}

						if (this.x < 0) {
							this.x = 0;
						}
					} //Moving on y
					else {
						this.y += d;
						if (this.y + this.image.height * scale > Canvas.height) {
							this.y -= d;
						}
						if (this.y < 0) {
							this.y = 0;
						}
					}
				}
			}
			const UPDATE_TIME = 1000 / 60;

			let timer = null;

			// Достаем Canvas из DOM
			let Canvas = document.getElementById("Canvas");
			// Получение контекста для работы с Canvas
			// let ctx = Canvas.getContext("2d");
			// Масштаб
			let scale = 0.1;
			// // Изменение размера области игры при запуске
			// Resize();
			// // Изменение размера облсти игры на размер окна.
			// window.addEventListener("resize", Resize);

			// //Forbidding openning the context menu to make the game play better on mobile devices
			// Canvas.addEventListener("contextmenu", function (e) {
			// 	e.preventDefault();
			// 	return false;
			// });

			// window.addEventListener("keydown", function (e) {
			// 	KeyDown(e);
			// }); //Listenning for keyboard events

			// Массив из игровых обектов
			let objects = [];

			// var roads = [new Road("images/road.jpg", 0), new Road("images/road.jpg", canvas.width)]; //Backgrounds

			// let player = new Car("images/car.png", canvas.width / 2, canvas.height / 2, true); //Player's object

			let speed = 5;

			Start();

			function Start() {
				timer = setInterval(Update, UPDATE_TIME); //обновляем игру 60 раз в минуту
			}

			function Stop() {
				clearInterval(timer); // остановка игры
				timer = null;
			}

			function Update() {
				if (RandomInteger(0, 10000) > 9700) {
					// генерируем новые объекты
					let randomObject = [
						"obj_round_blue",
						"obj_round_green",
						"obj_round_red",
						"obj_round_yellow",
					];
					const obj_round_blue = document.createElement("img");
					obj_round_blue.src = "img/obj_round_blue.png";
					const obj_round_green = document.createElement("img");
					obj_round_green.src = "img/obj_round_green.png";
					const obj_round_red = document.createElement("img");
					obj_round_red.src = "img/obj_round_red.png";
					const obj_round_yellow = document.createElement("img");
					obj_round_yellow.src = "img/obj_round_yellow.png";

					objects.push(
						new Object(
							randomObject,
							Math.floor(getRandom(0, window.innerWidth)),
							RandomInteger(250, 400) * -1
						)
					);
				}

				let isDead = false;

				// for (let i = 0; i < objects.length; i++) {
				// 	objects[i].Update();

				// 	if (objects[i].dead) {
				// 		isDead = true;
				// 	}
				// }

				// if (isDead) {
				// 	objects.shift();
				// }

				// Draw();
			}

			// function Draw() {
			// Работа с графикой
			// ctx.clearRect(0, 0, Canvas.width, Canvas.height); //Clearing the Canvas

			// DrawObj();

			// 	for (let i = 0; i < objects.length; i++) {
			// 		DrawObj(objects[i]);
			// 	}
			// }

			// function DrawObj(object) {
			// 	ctx.drawImage(
			// 		object.image,
			// 		0,
			// 		0,
			// 		object.image.width,
			// 		object.image.height,
			// 		object.x,
			// 		object.y,
			// 		object.image.width * scale,
			// 		object.image.height * scale
			// 	);
			// }

			function Resize() {
				Canvas.width = window.innerWidth;
				Canvas.height = window.innerHeight;
			}

			function RandomInteger(min, max) {
				let rand = min - 0.5 + Math.random() * (max - min + 1);
				return Math.round(rand);
			}

			// функция рандома
			function getRandom(min, max) {
				return Math.random() * (max - min) + min;
			}
		</script>
	</body>
</html>
